# 操作日志 (2025-07-03)

## 目标
将项目还原到稳定的基线状态，并验证所有核心功能的可用性。

## 过程

1.  **项目还原**:
    *   `git init`: 初始化本地git仓库。
    *   `git remote add origin https://github.com/dogami567/vertex-01`: 添加远程仓库。
    *   `git fetch origin`: 拉取远程信息。
    *   `git reset --hard origin/master`: 强制将本地文件与远程仓库同步，撤销所有本地修改。

2.  **启动服务**:
    *   进入 `vertex-openai-adapter` 目录。
    *   在后台成功启动了 `simplest.py` 服务。

3.  **功能验证**:
    *   **函数调用**: 运行 `test_function_calling.py`，测试通过。
    *   **视觉**: 运行 `test_vision.py`，API链路测试通过，但模型本身未返回有效内容。
    *   **聊天与流式传输**: 运行 `test_client.py`，聊天、流式传输和模型列表功能均测试通过。

## 结论
项目已成功还原到GitHub仓库的初始状态，所有核心功能的适配器代码均可正常工作。 

---

# 操作日志 (2025-07-04)

## 目标
为适配器增加联网功能，使模型能够调用工具（如网页搜索）来获取实时信息。

## 过程
1.  **项目规划**:
    *   更新 `TODO.md`，将"实现联网功能"设为当前最高优先级任务。
2.  **代码实现**:
    *   调研并确认使用 `Tool.from_google_search_retrieval` 来为模型开启Google搜索功能。
    *   修改 `simplest.py`，增加逻辑：当请求的模型名称以 `-search` 结尾时，自动为其添加搜索工具。
3.  **测试与调试**:
    *   创建 `test_web_search.py` 测试脚本。
    *   **问题1: `ModuleNotFoundError`**: 发现未安装 `openai` 等依赖。
    *   **问题2: `regex` 编译失败**: 在安装依赖时，发现 `regex==2023.12.25` 版本与Python 3.13不兼容。通过网络搜索，将其更新为 `regex==2024.11.6` 后解决。
    *   **问题3: `503 failed to connect`**: 依赖安装成功后，测试时遇到网络连接错误。
    *   **排查路径1 (错误):** 最初怀疑是Google Cloud的VPC服务控制导致，但经用户截图确认为独立项目，无此限制。
    *   **排查路径2 (正确):** 根据经验和记忆，判断为本地网络环境需要代理。
    *   **解决方案:** 在运行服务和测试脚本前，通过 `$env:HTTPS_PROXY="http://127.0.0.1:7890"` 命令设置代理环境变量。
4.  **功能验证**:
    *   在正确设置代理后，成功运行 `test_web_search.py`，模型能够正确回答需要联网查询的实时问题。联网功能实现成功。 